<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - TBAT Mock Exam 2568</title>
    
    <!-- Google Fonts - Noto Sans Thai -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS Variables - Variant 6 Color Palette */
        :root {
            --tbat-primary: #0d7276;
            --tbat-secondary: #529a94;
            --tbat-accent: #90bfc0;
            --tbat-bg: #cae0e1;
            --tbat-light: #fdfefe;
            --tbat-text: #2c3e50;
            --tbat-success: #27ae60;
            --tbat-warning: #f39c12;
            --tbat-danger: #e74c3c;
            --tbat-info: #3498db;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans Thai', sans-serif;
            background: linear-gradient(135deg, var(--tbat-bg) 0%, var(--tbat-light) 100%);
            min-height: 100vh;
            color: var(--tbat-text);
            line-height: 1.6;
        }

        /* Header Styles */
        .admin-header {
            background: var(--tbat-primary);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-logo {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .admin-user {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .admin-badge {
            background: var(--tbat-warning);
            color: var(--tbat-primary);
            padding: 0.25rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.875rem;
        }

        /* Sidebar Navigation */
        .admin-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            max-width: 1400px;
            margin: 0 auto;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            background: var(--tbat-light);
            border-right: 1px solid var(--tbat-accent);
            padding: 2rem 0;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: var(--tbat-text);
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-link:hover,
        .nav-link.active {
            background: var(--tbat-primary);
            color: white;
        }

        .nav-icon {
            font-size: 1.125rem;
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            padding: 2rem;
            background: transparent;
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 600;
            color: var(--tbat-primary);
            margin-bottom: 0.5rem;
        }

        .page-subtitle {
            color: var(--tbat-secondary);
            font-size: 1.125rem;
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--tbat-light);
            padding: 1.5rem;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .stat-card.primary {
            background: linear-gradient(135deg, var(--tbat-primary), var(--tbat-secondary));
            color: white;
        }

        .stat-card.success {
            background: linear-gradient(135deg, var(--tbat-success), #2ecc71);
            color: white;
        }

        .stat-card.warning {
            background: linear-gradient(135deg, var(--tbat-warning), #f1c40f);
            color: white;
        }

        .stat-card.info {
            background: linear-gradient(135deg, var(--tbat-info), #5dade2);
            color: white;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-title {
            font-size: 0.875rem;
            opacity: 0.9;
            font-weight: 500;
        }

        .stat-icon {
            font-size: 2rem;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-change {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        /* Content Sections */
        .content-section {
            background: var(--tbat-light);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--tbat-bg);
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--tbat-primary);
        }

        /* Forms and Inputs */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--tbat-text);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--tbat-accent);
            border-radius: 8px;
            font-family: 'Noto Sans Thai', sans-serif;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--tbat-primary);
        }

        .file-upload-area {
            border: 2px dashed var(--tbat-accent);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            background: var(--tbat-bg);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file-upload-area:hover,
        .file-upload-area.drag-over {
            border-color: var(--tbat-primary);
            background: var(--tbat-light);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--tbat-primary);
            margin-bottom: 1rem;
        }

        .upload-text {
            font-size: 1.125rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .upload-hint {
            color: var(--tbat-secondary);
            font-size: 0.875rem;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-family: 'Noto Sans Thai', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--tbat-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--tbat-secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(13,114,118,0.3);
        }

        .btn-success {
            background: var(--tbat-success);
            color: white;
        }

        .btn-success:hover {
            background: #229954;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            color: var(--tbat-primary);
            border: 2px solid var(--tbat-primary);
        }

        .btn-outline:hover {
            background: var(--tbat-primary);
            color: white;
        }

        .btn-danger {
            background: var(--tbat-danger);
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .data-table th,
        .data-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--tbat-bg);
        }

        .data-table th {
            background: var(--tbat-bg);
            font-weight: 600;
            color: var(--tbat-primary);
        }

        .data-table tr:hover {
            background: var(--tbat-bg);
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-success {
            background: var(--tbat-success);
            color: white;
        }

        .status-warning {
            background: var(--tbat-warning);
            color: white;
        }

        .status-pending {
            background: var(--tbat-accent);
            color: var(--tbat-primary);
        }

        /* Enhanced Mobile Responsive */
        @media (max-width: 768px) {
            .admin-layout {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: fixed;
                left: -280px;
                top: 80px;
                height: calc(100vh - 80px);
                width: 280px;
                z-index: 1000;
                transition: left 0.3s ease;
                box-shadow: 2px 0 8px rgba(0,0,0,0.1);
            }

            .sidebar.show {
                left: 0;
            }

            .mobile-menu-btn {
                display: block;
                background: none;
                border: none;
                color: white;
                font-size: 1.5rem;
                cursor: pointer;
                padding: 0.5rem;
                border-radius: 4px;
                transition: background-color 0.3s ease;
            }

            .mobile-menu-btn:hover {
                background: rgba(255,255,255,0.1);
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .page-title {
                font-size: 1.5rem;
            }

            .page-subtitle {
                font-size: 1rem;
            }

            /* Registration cards responsive */
            div[style*="grid-template-columns: 2fr 1fr"] {
                display: block !important;
            }

            div[style*="grid-template-columns: repeat(3, 1fr)"] {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }

            /* Form responsive */
            div[style*="grid-template-columns: 1fr 1fr"] {
                grid-template-columns: 1fr !important;
            }

            /* Table responsive */
            .data-table {
                font-size: 0.875rem;
            }

            .data-table th,
            .data-table td {
                padding: 0.5rem;
            }

            /* Hide less important columns on mobile */
            .data-table th:nth-child(3),
            .data-table td:nth-child(3),
            .data-table th:nth-child(6),
            .data-table td:nth-child(6) {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .header-container {
                padding: 0 10px;
            }

            .admin-logo {
                font-size: 1.25rem;
            }

            .admin-badge {
                font-size: 0.75rem;
                padding: 0.2rem 0.75rem;
            }

            .stat-card {
                padding: 1rem;
            }

            .stat-value {
                font-size: 2rem;
            }

            .content-section {
                padding: 1rem;
                margin-bottom: 1rem;
            }

            .btn {
                padding: 0.6rem 1rem;
                font-size: 0.8rem;
            }
        }

        /* Desktop responsive */
        @media (min-width: 769px) {
            .mobile-menu-btn {
                display: none;
            }
        }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Micro-animations and Enhanced Interactions */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Enhanced Card Animations */
        .stat-card {
            animation: fadeIn 0.6s ease-out;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .stat-card:nth-child(1) { animation-delay: 0.1s; }
        .stat-card:nth-child(2) { animation-delay: 0.2s; }
        .stat-card:nth-child(3) { animation-delay: 0.3s; }

        /* Content Section Animations */
        .content-section {
            animation: fadeIn 0.5s ease-out;
            transition: all 0.3s ease;
        }

        .content-section:hover {
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        /* Navigation Animations */
        .nav-link {
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: width 0.3s ease;
        }

        .nav-link:hover::before {
            width: 100%;
            animation: shimmer 0.6s ease-out;
        }

        /* Button Enhancements */
        .btn {
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        /* File Upload Area Animations */
        .file-upload-area {
            position: relative;
            overflow: hidden;
        }

        .file-upload-area::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--tbat-primary), var(--tbat-secondary), var(--tbat-accent));
            border-radius: 12px;
            opacity: 0;
            z-index: -1;
            transition: opacity 0.3s ease;
        }

        .file-upload-area:hover::after {
            opacity: 1;
            animation: pulse 2s infinite;
        }

        /* Table Row Animations */
        .data-table tbody tr {
            animation: slideIn 0.4s ease-out;
            transition: all 0.2s ease;
        }

        .data-table tbody tr:nth-child(odd) { animation-delay: 0.1s; }
        .data-table tbody tr:nth-child(even) { animation-delay: 0.2s; }

        .data-table tbody tr:hover {
            transform: translateX(4px);
            box-shadow: 2px 0 8px rgba(13,114,118,0.1);
        }

        /* Status Badge Animations */
        .status-badge {
            animation: scaleIn 0.3s ease-out;
            transition: all 0.2s ease;
        }

        .status-badge:hover {
            transform: scale(1.1);
        }

        /* Loading Spinner Enhancement */
        .spinner {
            animation: spin 1s linear infinite, pulse 2s ease-in-out infinite;
        }

        /* Form Control Focus Animation */
        .form-control {
            position: relative;
        }

        .form-control:focus {
            animation: pulse 0.3s ease-out;
        }

        /* Registration Cards Special Animations */
        div[style*="border: 2px solid #b8e6b8"],
        div[style*="border: 2px solid #90c695"],
        div[style*="border: 2px solid #ffb366"] {
            animation: fadeIn 0.6s ease-out;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        div[style*="border: 2px solid #b8e6b8"]:hover,
        div[style*="border: 2px solid #90c695"]:hover,
        div[style*="border: 2px solid #ffb366"]:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        /* Chemistry card delay */
        div[style*="border: 2px solid #b8e6b8"] { animation-delay: 0.1s; }
        /* Biology card delay */
        div[style*="border: 2px solid #90c695"] { animation-delay: 0.2s; }
        /* Physics card delay */
        div[style*="border: 2px solid #ffb366"] { animation-delay: 0.3s; }

        /* Enhanced Advanced Package Card Animation */
        div[style*="background: linear-gradient(135deg, var(--tbat-success), #2ecc71)"] {
            animation: fadeIn 0.8s ease-out 0.4s both;
            position: relative;
        }

        div[style*="background: linear-gradient(135deg, var(--tbat-success), #2ecc71)"]::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 3s ease-in-out infinite;
        }

        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Admin Header -->
    <header class="admin-header">
        <div class="header-container">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="mobile-menu-btn" onclick="toggleSidebar()">☰</button>
                <div class="admin-logo">
                    <span>⚙️</span>
                    <span>TBAT Admin Panel</span>
                </div>
            </div>
            <div class="admin-user">
                <span class="admin-badge">👨‍💼 Admin</span>
                <span>สวัสดี, ผู้ดูแลระบบ</span>
            </div>
        </div>
    </header>

    <!-- Admin Layout -->
    <div class="admin-layout">
        <!-- Sidebar -->
        <nav class="sidebar">
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#dashboard" class="nav-link active" data-section="dashboard">
                        <span class="nav-icon">📊</span>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#registrations" class="nav-link" data-section="registrations">
                        <span class="nav-icon">👥</span>
                        <span>การลงทะเบียน</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#results" class="nav-link" data-section="results">
                        <span class="nav-icon">📈</span>
                        <span>นำเข้าผลสอบ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#pdfs" class="nav-link" data-section="pdfs">
                        <span class="nav-icon">📚</span>
                        <span>จัดการเฉลย PDF</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">Dashboard</h1>
                    <p class="page-subtitle">ภาพรวมระบบสอบ TBAT Mock Exam 2568</p>
                </div>

                <!-- Statistics Cards -->
                <div class="dashboard-grid">
                    <div class="stat-card primary">
                        <div class="stat-header">
                            <div class="stat-title">ผู้สมัครทั้งหมด</div>
                            <div class="stat-icon">👥</div>
                        </div>
                        <div class="stat-value">523</div>
                        <div class="stat-change">+47 คนในสัปดาห์นี้</div>
                    </div>

                    <div class="stat-card success">
                        <div class="stat-header">
                            <div class="stat-title">สมาชิก Advanced Package</div>
                            <div class="stat-icon">✨</div>
                        </div>
                        <div class="stat-value">78</div>
                        <div class="stat-change">อัตราการแปลง 14.9%</div>
                    </div>

                    <div class="stat-card warning">
                        <div class="stat-header">
                            <div class="stat-title">อัตราการแปลง</div>
                            <div class="stat-icon">📊</div>
                        </div>
                        <div class="stat-value">14.9%</div>
                        <div class="stat-change">FREE → Advanced Package conversion</div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">การดำเนินการด่วน</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                        <button class="btn btn-primary" onclick="showSection('results')">
                            📊 นำเข้าผลสอบ
                        </button>
                        <button class="btn btn-success" onclick="showSection('pdfs')">
                            📚 อัปโหลดเฉลย PDF
                        </button>
                        <button class="btn btn-outline" onclick="showSection('registrations')">
                            👥 จัดการผู้ลงทะเบียน
                        </button>
                        <button class="btn btn-outline" onclick="exportRegistrationsCSV()">
                            📥 Export CSV Mapping
                        </button>
                    </div>
                </div>
            </div>

            <!-- PDF Management Section -->
            <div id="pdfs-section" class="content-section" style="display: none;">
                <div class="page-header">
                    <h1 class="page-title">จัดการเฉลย PDF</h1>
                    <p class="page-subtitle">อัปโหลดและจัดการไฟล์เฉลยสำหรับสมาชิก Advanced Package</p>
                </div>

                <!-- Upload Section -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">อัปโหลดเฉลยใหม่</h2>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                        <div>
                            <div class="form-group">
                                <label class="form-label">เลือกวิชา</label>
                                <select class="form-control" id="subject-select">
                                    <option value="">-- เลือกวิชา --</option>
                                    <option value="chemistry">เคมี</option>
                                    <option value="biology">ชีววิทยา</option>
                                    <option value="physics">ฟิสิกส์</option>
                                    <option value="all">ทั้ง 3 วิชา (รวม)</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">ชื่อไฟล์</label>
                                <input type="text" class="form-control" id="file-name" placeholder="เช่น: เฉลยเคมี_2568_พร้อมคำอธิบาย">
                            </div>

                            <div class="form-group">
                                <label class="form-label">คำอธิบาย</label>
                                <textarea class="form-control" id="file-description" rows="3" placeholder="คำอธิบายไฟล์เฉลย เช่น เฉลยละเอียดพร้อมคำอธิบายขั้นตอน"></textarea>
                            </div>
                        </div>

                        <div>
                            <div class="form-group">
                                <label class="form-label">อัปโหลดไฟล์ PDF</label>
                                <div class="file-upload-area" onclick="document.getElementById('pdf-file').click()">
                                    <div class="upload-icon">📄</div>
                                    <div class="upload-text">คลิกเพื่อเลือกไฟล์ PDF</div>
                                    <div class="upload-hint">หรือลากไฟล์มาวางที่นี่<br>ขนาดไฟล์สูงสุด 50MB</div>
                                    <input type="file" id="pdf-file" accept=".pdf" style="display: none;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button class="btn btn-success" onclick="uploadPDF()">
                            <span class="spinner" id="upload-spinner" style="display: none;"></span>
                            📚 อัปโหลดเฉลย PDF
                        </button>
                    </div>
                </div>

                <!-- Current PDFs -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">เฉลยที่มีอยู่</h2>
                        <button class="btn btn-outline" onclick="refreshPDFList()">🔄 รีเฟรช</button>
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>วิชา</th>
                                <th>ชื่อไฟล์</th>
                                <th>วันที่อัปโหลด</th>
                                <th>ขนาดไฟล์</th>
                                <th>สถานะ</th>
                                <th>การจัดการ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>เคมี</td>
                                <td>เฉลยเคมี_2568_พร้อมคำอธิบาย.pdf</td>
                                <td>15 ส.ค. 2568</td>
                                <td>2.3 MB</td>
                                <td><span class="status-badge status-success">เผยแพร่แล้ว</span></td>
                                <td>
                                    <button class="btn btn-outline" style="padding: 0.5rem;" onclick="previewPDF('chemistry')">👁️</button>
                                    <button class="btn btn-danger" style="padding: 0.5rem;" onclick="deletePDF('chemistry')">🗑️</button>
                                </td>
                            </tr>
                            <tr>
                                <td>ชีววิทยา</td>
                                <td>เฉลยชีววิทยา_2568.pdf</td>
                                <td>16 ส.ค. 2568</td>
                                <td>3.1 MB</td>
                                <td><span class="status-badge status-success">เผยแพร่แล้ว</span></td>
                                <td>
                                    <button class="btn btn-outline" style="padding: 0.5rem;" onclick="previewPDF('biology')">👁️</button>
                                    <button class="btn btn-danger" style="padding: 0.5rem;" onclick="deletePDF('biology')">🗑️</button>
                                </td>
                            </tr>
                            <tr>
                                <td>ฟิสิกส์</td>
                                <td>เฉลยฟิสิกส์_2568_draft.pdf</td>
                                <td>18 ส.ค. 2568</td>
                                <td>4.2 MB</td>
                                <td><span class="status-badge status-warning">ร่าง</span></td>
                                <td>
                                    <button class="btn btn-outline" style="padding: 0.5rem;" onclick="previewPDF('physics')">👁️</button>
                                    <button class="btn btn-success" style="padding: 0.5rem;" onclick="publishPDF('physics')">✅</button>
                                    <button class="btn btn-danger" style="padding: 0.5rem;" onclick="deletePDF('physics')">🗑️</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Results Import Section -->
            <div id="results-section" class="content-section" style="display: none;">
                <div class="page-header">
                    <h1 class="page-title">นำเข้าผลสอบ</h1>
                    <p class="page-subtitle">อัปโหลดไฟล์ผลสอบจากการสอบกระดาษ</p>
                </div>

                <!-- Import Instructions -->
                <div class="content-section" style="background: linear-gradient(135deg, #e3f2fd, #f3e5f5); border-left: 4px solid var(--tbat-info);">
                    <h3 style="color: var(--tbat-info); margin-bottom: 1rem;">📋 วิธีการนำเข้าผลสอบ</h3>
                    <ol style="margin-left: 1rem; line-height: 2;">
                        <li>เตรียมไฟล์ Excel หรือ CSV ที่มีข้อมูลผลสอบ</li>
                        <li>ตรวจสอบให้แน่ใจว่ามีคอลัมน์: รหัสสอบ, เคมี, ชีววิทยา, ฟิสิกส์</li>
                        <li>อัปโหลดไฟล์ผ่านระบบด้านล่าง</li>
                        <li>ระบบจะส่งผลสอบให้นักเรียนอัตโนมัติ</li>
                    </ol>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">อัปโหลดไฟล์ผลสอบ</h2>
                        </div>
                        
                        <div class="file-upload-area" onclick="document.getElementById('results-file').click()">
                            <div class="upload-icon">📊</div>
                            <div class="upload-text">เลือกไฟล์ผลสอบ</div>
                            <div class="upload-hint">Excel (.xlsx) หรือ CSV (.csv)<br>ขนาดไฟล์สูงสุด 10MB</div>
                            <input type="file" id="results-file" accept=".xlsx,.csv" style="display: none;">
                        </div>

                        <div style="text-align: center; margin-top: 1.5rem;">
                            <button class="btn btn-primary" onclick="importResults()">
                                📊 นำเข้าผลสอบ
                            </button>
                        </div>
                    </div>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">ตัวอย่างรูปแบบไฟล์</h2>
                        </div>
                        
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>รหัสสอบ</th>
                                    <th>เคมี</th>
                                    <th>ชีววิทยา</th>
                                    <th>ฟิสิกส์</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Advanced Package-2468-ALL</td>
                                    <td>52</td>
                                    <td>48</td>
                                    <td>52</td>
                                </tr>
                                <tr>
                                    <td>FREE-1357-CHM</td>
                                    <td>45</td>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>Advanced Package-9876-ALL</td>
                                    <td>58</td>
                                    <td>55</td>
                                    <td>49</td>
                                </tr>
                            </tbody>
                        </table>

                        <div style="margin-top: 1rem;">
                            <button class="btn btn-outline" onclick="downloadTemplate()">
                                📥 ดาวน์โหลดแม่แบบ
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Registrations Section -->
            <div id="registrations-section" class="content-section" style="display: none;">
                <div class="page-header">
                    <h1 class="page-title">จัดการการลงทะเบียน</h1>
                    <p class="page-subtitle">ดูรายการผู้สมัครและจัดการข้อมูล</p>
                </div>

                <!-- Registration Stats -->
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                    <!-- FREE Package Card -->
                    <div class="content-section" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-left: 4px solid var(--tbat-accent);">
                        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 1.5rem;">
                            <h3 style="color: var(--tbat-primary); margin: 0; display: flex; align-items: center; gap: 0.5rem;">
                                <span style="font-size: 1.5rem;">📚</span>
                                <span>ผู้สมัคร FREE Package (รวม 445 คน)</span>
                            </h3>
                            <div style="background: var(--tbat-accent); color: var(--tbat-primary); padding: 0.5rem 1rem; border-radius: 20px; font-weight: 600; font-size: 0.875rem;">
                                85.1% ของทั้งหมด
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem;">
                            <!-- Chemistry Card -->
                            <div style="background: linear-gradient(135deg, #e8f4f8, #f0f8ff); border-radius: 12px; padding: 1.5rem; text-align: center; border: 2px solid #b8e6b8;">
                                <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">🧪</div>
                                <div style="font-size: 0.875rem; color: var(--tbat-secondary); font-weight: 500; margin-bottom: 0.5rem;">เคมี</div>
                                <div style="font-size: 2.25rem; font-weight: 700; color: var(--tbat-primary); margin-bottom: 0.25rem;">189</div>
                                <div style="font-size: 0.75rem; color: var(--tbat-secondary); background: white; padding: 0.25rem 0.75rem; border-radius: 12px; display: inline-block;">
                                    42.5% ของ FREE
                                </div>
                            </div>
                            
                            <!-- Biology Card -->
                            <div style="background: linear-gradient(135deg, #f0f8e8, #f5ffef); border-radius: 12px; padding: 1.5rem; text-align: center; border: 2px solid #90c695;">
                                <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">🦠</div>
                                <div style="font-size: 0.875rem; color: var(--tbat-secondary); font-weight: 500; margin-bottom: 0.5rem;">ชีววิทยา</div>
                                <div style="font-size: 2.25rem; font-weight: 700; color: var(--tbat-primary); margin-bottom: 0.25rem;">134</div>
                                <div style="font-size: 0.75rem; color: var(--tbat-secondary); background: white; padding: 0.25rem 0.75rem; border-radius: 12px; display: inline-block;">
                                    30.1% ของ FREE
                                </div>
                            </div>
                            
                            <!-- Physics Card -->
                            <div style="background: linear-gradient(135deg, #fff3e8, #fff8f0); border-radius: 12px; padding: 1.5rem; text-align: center; border: 2px solid #ffb366;">
                                <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">⚛️</div>
                                <div style="font-size: 0.875rem; color: var(--tbat-secondary); font-weight: 500; margin-bottom: 0.5rem;">ฟิสิกส์</div>
                                <div style="font-size: 2.25rem; font-weight: 700; color: var(--tbat-primary); margin-bottom: 0.25rem;">122</div>
                                <div style="font-size: 0.75rem; color: var(--tbat-secondary); background: white; padding: 0.25rem 0.75rem; border-radius: 12px; display: inline-block;">
                                    27.4% ของ FREE
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Advanced Package Package Card -->
                    <div class="content-section" style="background: linear-gradient(135deg, var(--tbat-success), #2ecc71); color: white; text-align: center; position: relative; overflow: hidden;">
                        <div style="position: absolute; top: -20px; right: -20px; width: 60px; height: 60px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
                        <div style="position: absolute; bottom: -30px; left: -30px; width: 80px; height: 80px; background: rgba(255,255,255,0.05); border-radius: 50%;"></div>
                        
                        <div style="font-size: 3rem; margin-bottom: 1rem;">✨</div>
                        <h3 style="margin: 0 0 1rem 0; font-size: 1.125rem; font-weight: 600;">Advanced Package Package</h3>
                        <div style="font-size: 3rem; font-weight: 700; margin-bottom: 0.5rem;">78</div>
                        <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 1rem;">ชำระเงินแล้วทั้งหมด</div>
                        <div style="background: rgba(255,255,255,0.2); padding: 0.75rem; border-radius: 8px; font-size: 0.875rem;">
                            <div>🧪 เคมี</div>
                            <div>🦠 ชีววิทยา</div>
                            <div>⚛️ ฟิสิกส์</div>
                        </div>
                        <div style="margin-top: 1rem; font-size: 0.75rem; opacity: 0.8;">
                            14.9% conversion rate
                        </div>
                    </div>
                </div>

                <!-- Registration Table -->
                <!-- CSV Export Information -->
                <div class="content-section" style="background: linear-gradient(135deg, #e8f5e8, #f0f8ff); border-left: 4px solid var(--tbat-success);">
                    <h3 style="color: var(--tbat-success); margin-bottom: 1rem;">📋 ข้อมูล CSV Export สำหรับ Admin</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                        <div>
                            <h4 style="color: var(--tbat-primary); margin-bottom: 0.5rem;">📥 ไฟล์ Export จะมีข้อมูล:</h4>
                            <ul style="margin-left: 1rem; line-height: 1.8;">
                                <li><strong>exam_code</strong> - รหัสสอบ (สำคัญมาก! ใช้ mapping กับผลสอบ)</li>
                                <li><strong>full_name</strong> - ชื่อ-นามสกุลเต็ม</li>
                                <li><strong>email</strong> - อีเมล</li>
                                <li><strong>line_id</strong> - Line ID</li>
                                <li><strong>school</strong> - โรงเรียน</li>
                                <li><strong>grade</strong> - ชั้นปี</li>
                                <li><strong>package_type</strong> - FREE/Advanced Package</li>
                                <li><strong>subjects</strong> - วิชาที่สมัคร</li>
                                <li><strong>payment_status</strong> - สถานะการชำระเงิน</li>
                                <li><strong>registration_date</strong> - วันที่ลงทะเบียน</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: var(--tbat-primary); margin-bottom: 0.5rem;">📊 การใช้งาน CSV:</h4>
                            <ul style="margin-left: 1rem; line-height: 1.8;">
                                <li><strong>External Analytics</strong> - นำไปทำ stat ด้วย Excel/Google Sheets</li>
                                <li><strong>Results Mapping</strong> - ใช้ exam_code เชื่อมกับผลสอบ</li>
                                <li><strong>Communication</strong> - ส่งอีเมล/Line เป็น batch</li>
                                <li><strong>School Reports</strong> - จัดกลุ่มตามโรงเรียน</li>
                                <li><strong>Package Analysis</strong> - วิเคราะห์ FREE vs Advanced Package</li>
                            </ul>
                            <div style="margin-top: 1rem; padding: 0.75rem; background: white; border-radius: 8px; border: 1px solid var(--tbat-accent);">
                                <strong>⚠️ Developer Note:</strong><br>
                                exam_code ต้อง unique และใช้เป็น primary key สำหรับ mapping กับตารางผลสอบ
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Registration Table -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">รายการผู้ลงทะเบียน</h2>
                        <div>
                            <button class="btn btn-outline" onclick="exportRegistrationsCSV()">📥 Export CSV สำหรับ Mapping</button>
                            <button class="btn btn-success" onclick="sendExamCodes()">📧 ส่งรหัสสอบ</button>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 1rem; display: flex; gap: 1rem; align-items: center;">
                        <input type="text" class="form-control" placeholder="ค้นหาด้วยชื่อ, รหัสสอบ, หรืออีเมล" style="max-width: 300px;">
                        <select class="form-control" style="max-width: 200px;">
                            <option value="">ทุกประเภท</option>
                            <option value="free">FREE เท่านั้น</option>
                            <option value="vvip">Advanced Package เท่านั้น</option>
                        </select>
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>รหัสสอบ</th>
                                <th>ชื่อ-นามสกุล</th>
                                <th>โรงเรียน</th>
                                <th>ประเภท</th>
                                <th>สถานะ</th>
                                <th>วันที่ลงทะเบียน</th>
                                <th>จัดการ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Advanced Package-2468-ALL</td>
                                <td>วรพล สมศรี</td>
                                <td>ม.เชียงใหม่มัธยมศึกษา</td>
                                <td><span class="status-badge status-success">Advanced Package</span></td>
                                <td><span class="status-badge status-success">ชำระแล้ว</span></td>
                                <td>12 ส.ค. 2568</td>
                                <td>
                                    <button class="btn btn-outline" style="padding: 0.5rem;">👁️</button>
                                    <button class="btn btn-outline" style="padding: 0.5rem;">📧</button>
                                </td>
                            </tr>
                            <tr>
                                <td>FREE-1357-CHM</td>
                                <td>สมชาย ใจดี</td>
                                <td>ม.บ้านนอก</td>
                                <td><span class="status-badge status-pending">FREE (เคมี)</span></td>
                                <td><span class="status-badge status-success">สมบูรณ์</span></td>
                                <td>13 ส.ค. 2568</td>
                                <td>
                                    <button class="btn btn-outline" style="padding: 0.5rem;">👁️</button>
                                    <button class="btn btn-outline" style="padding: 0.5rem;">📧</button>
                                </td>
                            </tr>
                            <tr>
                                <td>FREE-7890-BIO</td>
                                <td>นิรชา ยิ้มแย้ม</td>
                                <td>ม.รัชมังคลาธาร</td>
                                <td><span class="status-badge status-pending">FREE (ชีววิทยา)</span></td>
                                <td><span class="status-badge status-success">สมบูรณ์</span></td>
                                <td>14 ส.ค. 2568</td>
                                <td>
                                    <button class="btn btn-outline" style="padding: 0.5rem;">👁️</button>
                                    <button class="btn btn-outline" style="padding: 0.5rem;">📧</button>
                                </td>
                            </tr>
                            <tr>
                                <td>FREE-5432-PHY</td>
                                <td>กิตติศักดิ์ มานะ</td>
                                <td>ม.วังไผ่</td>
                                <td><span class="status-badge status-pending">FREE (ฟิสิกส์)</span></td>
                                <td><span class="status-badge status-success">สมบูรณ์</span></td>
                                <td>15 ส.ค. 2568</td>
                                <td>
                                    <button class="btn btn-outline" style="padding: 0.5rem;">👁️</button>
                                    <button class="btn btn-outline" style="padding: 0.5rem;">📧</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Developer Remarks -->
    <div style="display: none;">
        <!-- 
        DEVELOPER IMPLEMENTATION NOTES:

        1. PDF UPLOAD SYSTEM:
           - Use multipart/form-data for file uploads
           - Store PDFs in cloud storage (AWS S3, Google Cloud)
           - Database: store metadata (filename, subject, upload_date, file_size, status)
           - Security: validate file type, scan for malware
           - Access control: only admins can upload, Advanced Package users can download

        2. RESULTS IMPORT:
           - Parse Excel/CSV using libraries (openpyxl, pandas)
           - Validate exam codes against registration database
           - Bulk insert results with transaction rollback on errors
           - Send notifications after successful import
           - Log all import activities for audit

        3. AUTHENTICATION & AUTHORIZATION:
           - Implement proper admin authentication
           - Role-based access control (super admin, content admin, etc.)
           - Session management with timeout
           - Audit log for all admin actions

        4. API ENDPOINTS NEEDED:
           - POST /admin/pdf/upload - Upload answer key PDF
           - GET /admin/pdfs - List all PDFs
           - DELETE /admin/pdf/{id} - Delete PDF
           - POST /admin/results/import - Import results from file
           - GET /admin/registrations - List all registrations
           - GET /admin/stats - Dashboard statistics

        5. DATABASE SCHEMA SUGGESTIONS:
           - answer_keys: id, subject, filename, file_path, upload_date, status
           - exam_results: id, exam_code, chemistry_score, biology_score, physics_score
           - registrations: id, exam_code, name, school, package_type, payment_status
           - admin_logs: id, admin_id, action, details, timestamp

        6. SECURITY CONSIDERATIONS:
           - Input validation and sanitization
           - File upload restrictions (size, type, content)
           - Rate limiting for API endpoints
           - HTTPS only for admin panel
           - Regular security audits
        -->
    </div>

    <script>
        // Navigation functionality
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('[id$="-section"]').forEach(section => {
                section.style.display = 'none';
            });

            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });

            // Show selected section
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.style.display = 'block';
            }

            // Add active class to clicked nav link
            const targetLink = document.querySelector(`[data-section="${sectionName}"]`);
            if (targetLink) {
                targetLink.classList.add('active');
            }
        }

        // PDF Management Functions
        function uploadPDF() {
            const fileInput = document.getElementById('pdf-file');
            const subjectSelect = document.getElementById('subject-select');
            const fileName = document.getElementById('file-name');
            
            if (!fileInput.files[0]) {
                alert('กรุณาเลือกไฟล์ PDF');
                return;
            }
            
            if (!subjectSelect.value) {
                alert('กรุณาเลือกวิชา');
                return;
            }

            // Show loading spinner
            document.getElementById('upload-spinner').style.display = 'inline-block';
            
            // Simulate upload (replace with actual API call)
            setTimeout(() => {
                document.getElementById('upload-spinner').style.display = 'none';
                alert(`อัปโหลดเฉลย${subjectSelect.options[subjectSelect.selectedIndex].text}สำเร็จ!\n\nDeveloper: Implement actual file upload to server`);
                
                // Reset form
                fileInput.value = '';
                fileName.value = '';
                document.getElementById('file-description').value = '';
                subjectSelect.value = '';
                
                // Refresh PDF list
                refreshPDFList();
            }, 2000);
        }

        function refreshPDFList() {
            alert('รีเฟรชรายการ PDF\n\nDeveloper: Fetch updated PDF list from API');
        }

        function previewPDF(subject) {
            alert(`เปิดดูไฟล์เฉลย${subject}\n\nDeveloper: Open PDF in new tab/modal`);
        }

        function deletePDF(subject) {
            if (confirm('ต้องการลบไฟล์เฉลยนี้หรือไม่?')) {
                alert(`ลบไฟล์เฉลย${subject}\n\nDeveloper: Call delete API and refresh list`);
            }
        }

        function publishPDF(subject) {
            if (confirm('ต้องการเผยแพร่ไฟล์เฉลยนี้หรือไม่? นักเรียน Advanced Package จะสามารถดาวน์โหลดได้ทันที')) {
                alert(`เผยแพร่เฉลย${subject}สำเร็จ!\n\nDeveloper: Update PDF status to published`);
            }
        }

        // Results Import Functions
        function importResults() {
            const fileInput = document.getElementById('results-file');
            
            if (!fileInput.files[0]) {
                alert('กรุณาเลือกไฟล์ผลสอบ');
                return;
            }

            if (confirm('ต้องการนำเข้าผลสอบหรือไม่? ระบบจะส่งผลให้นักเรียนอัตโนมัติ')) {
                alert('เริ่มนำเข้าผลสอบ...\n\nDeveloper: Process file and insert results to database');
                
                // Simulate processing
                setTimeout(() => {
                    alert('นำเข้าผลสอบสำเร็จ! ส่งผลให้นักเรียน 523 คนแล้ว');
                }, 3000);
            }
        }

        function downloadTemplate() {
            alert('ดาวน์โหลดไฟล์แม่แบบ Excel\n\nDeveloper: Generate and download template file');
        }

        // Registration Management Functions
        function exportRegistrationsCSV() {
            alert('ส่งออก CSV สำหรับ External Analytics และ Results Mapping\n\nDeveloper: Generate CSV with exam_code as primary key for results mapping');
        }

        function exportStatistics() {
            alert('ส่งออกสถิติเป็น CSV สำหรับวิเคราะห์ข้อมูล\n\nDeveloper: Export aggregated statistics for external analysis');
        }

        function sendExamCodes() {
            if (confirm('ต้องการส่งรหัสสอบให้ผู้ลงทะเบียนทั้งหมดหรือไม่?')) {
                alert('เริ่มส่งรหัสสอบทาง Email และ Line\n\nDeveloper: Send bulk notifications to all registered users');
            }
        }

        // Navigation event listeners
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const section = this.getAttribute('data-section');
                if (section) {
                    showSection(section);
                }
            });
        });

        // File upload drag and drop functionality
        document.querySelectorAll('.file-upload-area').forEach(area => {
            area.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('drag-over');
            });

            area.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.classList.remove('drag-over');
            });

            area.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('drag-over');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    // Handle dropped file
                    const targetInput = this.querySelector('input[type="file"]') || 
                                       document.querySelector('input[type="file"]');
                    if (targetInput) {
                        targetInput.files = files;
                        alert(`ได้รับไฟล์: ${files[0].name}`);
                    }
                }
            });
        });

        // Mobile Sidebar Toggle
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('show');
            
            // Close sidebar when clicking outside
            if (sidebar.classList.contains('show')) {
                document.addEventListener('click', closeSidebarOnOutsideClick);
            } else {
                document.removeEventListener('click', closeSidebarOnOutsideClick);
            }
        }

        function closeSidebarOnOutsideClick(event) {
            const sidebar = document.querySelector('.sidebar');
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            
            if (!sidebar.contains(event.target) && !mobileMenuBtn.contains(event.target)) {
                sidebar.classList.remove('show');
                document.removeEventListener('click', closeSidebarOnOutsideClick);
            }
        }

        // Enhanced Button Click Effects
        function addRippleEffect(event) {
            const button = event.currentTarget;
            const ripple = document.createElement('span');
            const rect = button.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = event.clientX - rect.left - size / 2;
            const y = event.clientY - rect.top - size / 2;
            
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = x + 'px';
            ripple.style.top = y + 'px';
            ripple.classList.add('ripple');
            
            button.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 600);
        }

        // Loading State Management
        function setLoadingState(element, isLoading) {
            if (isLoading) {
                element.classList.add('loading');
                const spinner = element.querySelector('.spinner');
                if (spinner) {
                    spinner.style.display = 'inline-block';
                }
            } else {
                element.classList.remove('loading');
                const spinner = element.querySelector('.spinner');
                if (spinner) {
                    spinner.style.display = 'none';
                }
            }
        }

        // Enhanced Form Validation with Animations
        function validateForm(formElement) {
            const inputs = formElement.querySelectorAll('.form-control[required]');
            let isValid = true;
            
            inputs.forEach(input => {
                if (!input.value.trim()) {
                    input.style.animation = 'shake 0.5s ease-in-out';
                    input.addEventListener('animationend', () => {
                        input.style.animation = '';
                    });
                    isValid = false;
                }
            });
            
            return isValid;
        }

        // Smooth Scroll for Navigation
        function smoothScrollTo(target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }

        // Enhanced Stats Counter Animation
        function animateCounter(element, start, end, duration) {
            const range = end - start;
            const increment = range / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                element.textContent = Math.round(current);
                
                if (current >= end) {
                    element.textContent = end;
                    clearInterval(timer);
                }
            }, 16);
        }

        // Initialize animations on page load
        function initializeAnimations() {
            // Animate stat counters
            const statValues = document.querySelectorAll('.stat-value');
            statValues.forEach((element, index) => {
                const value = parseInt(element.textContent.replace(/[^\d]/g, ''));
                if (value) {
                    element.textContent = '0';
                    setTimeout(() => {
                        animateCounter(element, 0, value, 2000);
                    }, index * 200 + 500);
                }
            });

            // Add ripple effect to buttons
            const buttons = document.querySelectorAll('.btn');
            buttons.forEach(button => {
                button.addEventListener('click', addRippleEffect);
            });
        }

        // Progressive Enhancement for Interactions
        function enhanceInteractions() {
            // Enhanced file upload feedback
            const fileInputs = document.querySelectorAll('input[type="file"]');
            fileInputs.forEach(input => {
                input.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const uploadArea = input.closest('.file-upload-area');
                        if (uploadArea) {
                            uploadArea.style.animation = 'pulse 0.3s ease-out';
                            const uploadText = uploadArea.querySelector('.upload-text');
                            if (uploadText) {
                                uploadText.textContent = `✓ เลือกไฟล์: ${file.name}`;
                            }
                        }
                    }
                });
            });

            // Enhanced search with real-time feedback
            const searchInputs = document.querySelectorAll('input[placeholder*="ค้นหา"]');
            searchInputs.forEach(input => {
                input.addEventListener('input', (e) => {
                    const value = e.target.value;
                    if (value.length > 2) {
                        input.style.animation = 'pulse 0.2s ease-out';
                        // Simulate search feedback
                        setTimeout(() => {
                            input.style.animation = '';
                        }, 200);
                    }
                });
            });
        }

        // Initialize dashboard on load
        window.addEventListener('load', function() {
            showSection('dashboard');
            initializeAnimations();
            enhanceInteractions();
        });

        // Handle window resize for responsive adjustments
        window.addEventListener('resize', function() {
            const sidebar = document.querySelector('.sidebar');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('show');
            }
        });
    </script>
</body>
</html>