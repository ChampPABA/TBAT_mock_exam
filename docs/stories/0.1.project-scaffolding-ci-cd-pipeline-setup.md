# Story 0.1: Project Scaffolding & CI/CD Pipeline Setup

## Status
Draft

## Story
**As a** Developer,
**I want** to set up the complete project structure with automated CI/CD pipeline,
**so that** all subsequent development can deploy reliably and consistently to production.

## Acceptance Criteria
1. **AC1:** Next.js 14+ monorepo created with Turborepo structure containing /apps/web, /packages/ui, /packages/lib directories

2. **AC2:** TypeScript configuration established with strict mode, path aliases (@/), and consistent tsconfig across all packages

3. **AC3:** Tailwind CSS + shadcn/ui integrated with medical color palette (#0d7276 primary, #529a9d secondary, #cae0e1 light)

4. **AC4:** GitHub Actions CI/CD pipeline configured with automated testing, type checking, and Vercel deployment

5. **AC5:** ESLint + Prettier + Husky pre-commit hooks enforcing code quality standards

6. **AC6:** Environment variable structure established for development, staging, production with secure secrets management

7. **AC7:** Docker development environment configured with:
   - Docker Compose orchestration for Next.js app, PostgreSQL, and Redis containers
   - Hot reload volumes for rapid development cycles
   - Environment parity between local development and production
   - Containerized database with persistent data volumes

## Tasks / Subtasks
- [ ] Task 1: Initialize Turborepo monorepo structure (AC: 1)
  - [ ] Run `npx create-turbo@latest` with TypeScript template
  - [ ] Create /apps/web Next.js 14+ application with App Router
  - [ ] Create /packages/ui shared component library
  - [ ] Create /packages/lib shared utility library
  - [ ] Configure turbo.json for build and dev pipelines

- [ ] Task 2: Configure TypeScript across all packages (AC: 2)
  - [ ] Set up strict mode TypeScript configuration
  - [ ] Configure path aliases (@/) in all tsconfig files
  - [ ] Establish consistent TypeScript config inheritance
  - [ ] Add TypeScript to build and dev scripts

- [ ] Task 3: Install and configure UI framework (AC: 3)
  - [ ] Install Tailwind CSS in /apps/web and /packages/ui
  - [ ] Initialize shadcn/ui with `npx shadcn-ui@latest init`
  - [ ] Configure custom color palette in tailwind.config.js
  - [ ] Install and configure Prompt font for Thai language support
  - [ ] Test component installation with basic shadcn/ui components

- [ ] Task 4: Set up GitHub Actions CI/CD (AC: 4)
  - [ ] Create .github/workflows/ci.yml with test, lint, typecheck jobs
  - [ ] Configure Vercel integration for automatic deployments
  - [ ] Set up preview deployments for pull requests
  - [ ] Configure deployment protection rules for main branch

- [ ] Task 5: Configure code quality tools (AC: 5)
  - [ ] Install and configure ESLint with Next.js and TypeScript rules
  - [ ] Install and configure Prettier with consistent formatting
  - [ ] Set up Husky for pre-commit hooks
  - [ ] Configure lint-staged for staged file processing
  - [ ] Add code quality scripts to package.json

- [ ] Task 6: Environment configuration (AC: 6)
  - [ ] Create .env.example with all required variables
  - [ ] Set up environment variable validation with Zod
  - [ ] Configure different environments (development, staging, production)
  - [ ] Document environment setup in README

- [ ] Task 7: Docker development setup (AC: 7)
  - [ ] Create Dockerfile for Next.js application
  - [ ] Create docker-compose.yml with Next.js, PostgreSQL, Redis services
  - [ ] Configure hot reload volumes for development
  - [ ] Set up persistent data volumes for database
  - [ ] Create development startup scripts

## Dev Notes

### Previous Story Insights
This is the foundation story - no previous dependencies.

### Technology Stack Requirements
[Source: docs/architecture/section-3-tech-stack.md]
- **Framework**: Next.js 14+ with App Router and TypeScript 5.0+
- **UI Library**: shadcn/ui with Tailwind CSS 3.3+ and Radix UI
- **Monorepo**: Turborepo architecture planned
- **Package Manager**: pnpm 8.0+ for dependency management
- **Build Tool**: Next.js Built-in with optimized bundling
- **Linting**: ESLint 8.0+ and Prettier 3.0+

### Project Structure Requirements
[Source: docs/architecture/section-3-tech-stack.md#project-structure-enhanced]
```
/apps/
  /web/                    # Next.js application
/packages/
  /ui/                     # Shared shadcn/ui components  
  /lib/                    # Shared utilities
  /mock-services/          # Mock data services (Phase 1)
  /mcp-servers/            # MCP configurations for AI features
  /playwright-tests/       # E2E test suites
```

### Color Palette Configuration
[Source: docs/front-end-spec/branding-style-guide.md#color-palette]
Tailwind config custom colors:
- `primary`: #0d7276 (main CTAs, headers)
- `secondary`: #529a9d (hover states, secondary buttons)
- `light`: #cae0e1 (backgrounds, borders)
- `accent`: #90bfc0 (highlights, progress)

### Docker Configuration Requirements
[Source: docs/architecture/section-3-tech-stack.md#development-strategy]
- **PostgreSQL**: 15+ with persistent volumes
- **Redis**: For session management and caching
- **Next.js**: Hot reload for rapid development
- **Environment Parity**: Match production deployment structure

### File Locations
Based on Turborepo monorepo structure:
- Root: `turbo.json`, `package.json`, `docker-compose.yml`
- Apps: `/apps/web/` (main Next.js application)
- Packages: `/packages/ui/`, `/packages/lib/`
- Config: `.github/workflows/`, `.env.example`

### Technical Constraints
- **TypeScript Strict Mode**: All code must pass strict type checking
- **Exam-Critical Reliability**: Zero-downtime deployment pipeline
- **Performance Targets**: <2 second load times, 200+ concurrent users
- **Thai Language Support**: Prompt font integration required

### CI/CD Pipeline Requirements
[Source: docs/architecture/section-3-tech-stack.md#quality-assurance]
Pipeline stages:
1. **Lint**: ESLint code quality checks
2. **Type Check**: TypeScript compilation validation
3. **Test**: Jest unit tests (when implemented)
4. **Build**: Next.js production build verification
5. **Deploy**: Vercel automatic deployment

### Environment Variables Structure
Required environment variables:
```
# Database
DATABASE_URL=
POSTGRES_PRISMA_URL=
POSTGRES_URL_NON_POOLING=

# Authentication
NEXTAUTH_SECRET=
NEXTAUTH_URL=

# Payments
STRIPE_PUBLISHABLE_KEY=
STRIPE_SECRET_KEY=

# Email
RESEND_API_KEY=

# Redis
REDIS_URL=
```

## Testing

### Testing Standards
- **Build Verification**: All packages build successfully
- **Type Safety**: Zero TypeScript errors across all packages
- **Code Quality**: ESLint and Prettier rules pass
- **Integration**: Docker Compose services start correctly
- **Deployment**: Successful deployment to Vercel

### Manual Verification
- Turborepo commands (`turbo dev`, `turbo build`) work correctly
- Hot reload functions in development environment
- shadcn/ui components install and render properly
- GitHub Actions pipeline completes without errors
- Docker containers start and communicate correctly

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-06 | 1.0 | Initial story creation | Scrum Master |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

## QA Results
*This section will be populated by the QA agent after implementation review*